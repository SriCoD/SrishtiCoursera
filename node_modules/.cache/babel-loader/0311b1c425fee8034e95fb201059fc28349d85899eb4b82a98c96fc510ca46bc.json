{"ast":null,"code":"import{useEffect,useState}from\"react\";import{useForm}from\"react-hook-form\";import{useDispatch,useSelector}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import{editCourseDetails}from\"../../../../../services/operations/courseDetailsAPI\";import{resetCourseState,setStep}from\"../../../../../slices/courseSlice\";import{COURSE_STATUS}from\"../../../../../utils/constants\";import IconBtn from\"../../../../common/IconBtn\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PublishCourse(){const{register,handleSubmit,setValue,getValues}=useForm();const dispatch=useDispatch();const navigate=useNavigate();const{token}=useSelector(state=>state.auth);const{course}=useSelector(state=>state.course);const[loading,setLoading]=useState(false);useEffect(()=>{if((course===null||course===void 0?void 0:course.status)===COURSE_STATUS.PUBLISHED){setValue(\"public\",true);}},[]);const goBack=()=>{dispatch(setStep(2));};const goToCourses=()=>{dispatch(resetCourseState());navigate(\"/dashboard/my-courses\");};const handleCoursePublish=async()=>{// check if form has been updated or not\nif((course===null||course===void 0?void 0:course.status)===COURSE_STATUS.PUBLISHED&&getValues(\"public\")===true||(course===null||course===void 0?void 0:course.status)===COURSE_STATUS.DRAFT&&getValues(\"public\")===false){// form has not been updated\n// no need to make api call\ngoToCourses();return;}const formData=new FormData();formData.append(\"courseId\",course._id);const courseStatus=getValues(\"public\")?COURSE_STATUS.PUBLISHED:COURSE_STATUS.DRAFT;formData.append(\"status\",courseStatus);setLoading(true);const result=await editCourseDetails(formData,token);if(result){goToCourses();}setLoading(false);};const onSubmit=data=>{// console.log(data)\nhandleCoursePublish();};return/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-md border-[1px] border-richblack-700 bg-richblack-800 p-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-richblack-5\",children:\"Publish Settings\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"div\",{className:\"my-6 mb-8\",children:/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"public\",className:\"inline-flex items-center text-lg\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"public\",...register(\"public\"),className:\"border-gray-300 h-4 w-4 rounded bg-richblack-500 text-richblack-400 focus:ring-2 focus:ring-richblack-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-richblack-400\",children:\"Make this course as public\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-auto flex max-w-max items-center gap-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:loading,type:\"button\",onClick:goBack,className:\"flex cursor-pointer items-center gap-x-2 rounded-md bg-richblack-300 py-[8px] px-[20px] font-semibold text-richblack-900\",children:\"Back\"}),/*#__PURE__*/_jsx(IconBtn,{disabled:loading,text:\"Save Changes\"})]})]})]});}","map":{"version":3,"names":["useEffect","useState","useForm","useDispatch","useSelector","useNavigate","editCourseDetails","resetCourseState","setStep","COURSE_STATUS","IconBtn","jsx","_jsx","jsxs","_jsxs","PublishCourse","register","handleSubmit","setValue","getValues","dispatch","navigate","token","state","auth","course","loading","setLoading","status","PUBLISHED","goBack","goToCourses","handleCoursePublish","DRAFT","formData","FormData","append","_id","courseStatus","result","onSubmit","data","className","children","htmlFor","type","id","disabled","onClick","text"],"sources":["C:/Users/s/Desktop/StudyNotion-An-Online-Education-Platform/src/components/core/Dashboard/AddCourse/PublishCourse/index.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport { useNavigate } from \"react-router-dom\"\r\n\r\nimport { editCourseDetails } from \"../../../../../services/operations/courseDetailsAPI\"\r\nimport { resetCourseState, setStep } from \"../../../../../slices/courseSlice\"\r\nimport { COURSE_STATUS } from \"../../../../../utils/constants\"\r\nimport IconBtn from \"../../../../common/IconBtn\"\r\n\r\nexport default function PublishCourse() {\r\n  const { register, handleSubmit, setValue, getValues } = useForm()\r\n\r\n  const dispatch = useDispatch()\r\n  const navigate = useNavigate()\r\n  const { token } = useSelector((state) => state.auth)\r\n  const { course } = useSelector((state) => state.course)\r\n  const [loading, setLoading] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (course?.status === COURSE_STATUS.PUBLISHED) {\r\n      setValue(\"public\", true)\r\n    }\r\n  }, [])\r\n\r\n  const goBack = () => {\r\n    dispatch(setStep(2))\r\n  }\r\n\r\n  const goToCourses = () => {\r\n    dispatch(resetCourseState())\r\n    navigate(\"/dashboard/my-courses\")\r\n  }\r\n\r\n  const handleCoursePublish = async () => {\r\n    // check if form has been updated or not\r\n    if (\r\n      (course?.status === COURSE_STATUS.PUBLISHED &&\r\n        getValues(\"public\") === true) ||\r\n      (course?.status === COURSE_STATUS.DRAFT && getValues(\"public\") === false)\r\n    ) {\r\n      // form has not been updated\r\n      // no need to make api call\r\n      goToCourses()\r\n      return\r\n    }\r\n    const formData = new FormData()\r\n    formData.append(\"courseId\", course._id)\r\n    const courseStatus = getValues(\"public\")\r\n      ? COURSE_STATUS.PUBLISHED\r\n      : COURSE_STATUS.DRAFT\r\n    formData.append(\"status\", courseStatus)\r\n    setLoading(true)\r\n    const result = await editCourseDetails(formData, token)\r\n    if (result) {\r\n      goToCourses()\r\n    }\r\n    setLoading(false)\r\n  }\r\n\r\n  const onSubmit = (data) => {\r\n    // console.log(data)\r\n    handleCoursePublish()\r\n  }\r\n\r\n  return (\r\n    <div className=\"rounded-md border-[1px] border-richblack-700 bg-richblack-800 p-6\">\r\n      <p className=\"text-2xl font-semibold text-richblack-5\">\r\n        Publish Settings\r\n      </p>\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n        {/* Checkbox */}\r\n        <div className=\"my-6 mb-8\">\r\n          <label htmlFor=\"public\" className=\"inline-flex items-center text-lg\">\r\n            <input\r\n              type=\"checkbox\"\r\n              id=\"public\"\r\n              {...register(\"public\")}\r\n              className=\"border-gray-300 h-4 w-4 rounded bg-richblack-500 text-richblack-400 focus:ring-2 focus:ring-richblack-5\"\r\n            />\r\n            <span className=\"ml-2 text-richblack-400\">\r\n              Make this course as public\r\n            </span>\r\n          </label>\r\n        </div>\r\n\r\n        {/* Next Prev Button */}\r\n        <div className=\"ml-auto flex max-w-max items-center gap-x-4\">\r\n          <button\r\n            disabled={loading}\r\n            type=\"button\"\r\n            onClick={goBack}\r\n            className=\"flex cursor-pointer items-center gap-x-2 rounded-md bg-richblack-300 py-[8px] px-[20px] font-semibold text-richblack-900\"\r\n          >\r\n            Back\r\n          </button>\r\n          <IconBtn disabled={loading} text=\"Save Changes\" />\r\n        </div>\r\n      </form>\r\n    </div>\r\n  )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}