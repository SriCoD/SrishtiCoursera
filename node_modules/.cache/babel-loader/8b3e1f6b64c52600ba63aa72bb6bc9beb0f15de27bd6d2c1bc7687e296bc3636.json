{"ast":null,"code":"import{useState}from\"react\";import{useForm}from\"react-hook-form\";import{toast}from\"react-hot-toast\";import{IoAddCircleOutline}from\"react-icons/io5\";import{MdNavigateNext}from\"react-icons/md\";import{useDispatch,useSelector}from\"react-redux\";import{createSection,updateSection}from\"../../../../../services/operations/courseDetailsAPI\";import{setCourse,setEditCourse,setStep}from\"../../../../../slices/courseSlice\";import IconBtn from\"../../../../common/IconBtn\";import NestedView from\"./NestedView\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function CourseBuilderForm(){const{register,handleSubmit,setValue,formState:{errors}}=useForm();const{course}=useSelector(state=>state.course);const{token}=useSelector(state=>state.auth);const[loading,setLoading]=useState(false);const[editSectionName,setEditSectionName]=useState(null);const dispatch=useDispatch();// handle form submission\nconst onSubmit=async data=>{// console.log(data)\nsetLoading(true);let result;if(editSectionName){result=await updateSection({sectionName:data.sectionName,sectionId:editSectionName,courseId:course._id},token);// console.log(\"edit\", result)\n}else{result=await createSection({sectionName:data.sectionName,courseId:course._id},token);}if(result){// console.log(\"section result\", result)\ndispatch(setCourse(result));setEditSectionName(null);setValue(\"sectionName\",\"\");}setLoading(false);};const cancelEdit=()=>{setEditSectionName(null);setValue(\"sectionName\",\"\");};const handleChangeEditSectionName=(sectionId,sectionName)=>{if(editSectionName===sectionId){cancelEdit();return;}setEditSectionName(sectionId);setValue(\"sectionName\",sectionName);};const goToNext=()=>{if(course.courseContent.length===0){toast.error(\"Please add atleast one section\");return;}if(course.courseContent.some(section=>section.subSection.length===0)){toast.error(\"Please add atleast one lecture in each section\");return;}dispatch(setStep(3));};const goBack=()=>{dispatch(setStep(1));dispatch(setEditCourse(true));};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-8 rounded-md border-[1px] border-richblack-700 bg-richblack-800 p-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-richblack-5\",children:\"Course Builder\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"text-sm text-richblack-5\",htmlFor:\"sectionName\",children:[\"Section Name \",/*#__PURE__*/_jsx(\"sup\",{className:\"text-pink-200\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"sectionName\",disabled:loading,placeholder:\"Add a section to build your course\",...register(\"sectionName\",{required:true}),className:\"form-style w-full\"}),errors.sectionName&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-xs tracking-wide text-pink-200\",children:\"Section name is required\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-end gap-x-4\",children:[/*#__PURE__*/_jsx(IconBtn,{type:\"submit\",disabled:loading,text:editSectionName?\"Edit Section Name\":\"Create Section\",outline:true,children:/*#__PURE__*/_jsx(IoAddCircleOutline,{size:20,className:\"text-yellow-50\"})}),editSectionName&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:cancelEdit,className:\"text-sm text-richblack-300 underline\",children:\"Cancel Edit\"})]})]}),course.courseContent.length>0&&/*#__PURE__*/_jsx(NestedView,{handleChangeEditSectionName:handleChangeEditSectionName}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:goBack,className:\"flex cursor-pointer items-center gap-x-2 rounded-md bg-richblack-300 py-[8px] px-[20px] font-semibold text-richblack-900\",children:\"Back\"}),/*#__PURE__*/_jsx(IconBtn,{disabled:loading,text:\"Next\",onclick:goToNext,children:/*#__PURE__*/_jsx(MdNavigateNext,{})})]})]});}","map":{"version":3,"names":["useState","useForm","toast","IoAddCircleOutline","MdNavigateNext","useDispatch","useSelector","createSection","updateSection","setCourse","setEditCourse","setStep","IconBtn","NestedView","jsx","_jsx","jsxs","_jsxs","CourseBuilderForm","register","handleSubmit","setValue","formState","errors","course","state","token","auth","loading","setLoading","editSectionName","setEditSectionName","dispatch","onSubmit","data","result","sectionName","sectionId","courseId","_id","cancelEdit","handleChangeEditSectionName","goToNext","courseContent","length","error","some","section","subSection","goBack","className","children","htmlFor","id","disabled","placeholder","required","type","text","outline","size","onClick","onclick"],"sources":["C:/Users/s/Desktop/StudyNotion-An-Online-Education-Platform/src/components/core/Dashboard/AddCourse/CourseBuilder/CourseBuilderForm.jsx"],"sourcesContent":["import { useState } from \"react\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { toast } from \"react-hot-toast\"\r\nimport { IoAddCircleOutline } from \"react-icons/io5\"\r\nimport { MdNavigateNext } from \"react-icons/md\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\n\r\nimport {\r\n  createSection,\r\n  updateSection,\r\n} from \"../../../../../services/operations/courseDetailsAPI\"\r\nimport {\r\n  setCourse,\r\n  setEditCourse,\r\n  setStep,\r\n} from \"../../../../../slices/courseSlice\"\r\nimport IconBtn from \"../../../../common/IconBtn\"\r\nimport NestedView from \"./NestedView\"\r\n\r\nexport default function CourseBuilderForm() {\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    setValue,\r\n    formState: { errors },\r\n  } = useForm()\r\n\r\n  const { course } = useSelector((state) => state.course)\r\n  const { token } = useSelector((state) => state.auth)\r\n  const [loading, setLoading] = useState(false)\r\n  const [editSectionName, setEditSectionName] = useState(null)\r\n  const dispatch = useDispatch()\r\n\r\n  // handle form submission\r\n  const onSubmit = async (data) => {\r\n    // console.log(data)\r\n    setLoading(true)\r\n\r\n    let result\r\n\r\n    if (editSectionName) {\r\n      result = await updateSection(\r\n        {\r\n          sectionName: data.sectionName,\r\n          sectionId: editSectionName,\r\n          courseId: course._id,\r\n        },\r\n        token\r\n      )\r\n      // console.log(\"edit\", result)\r\n    } else {\r\n      result = await createSection(\r\n        {\r\n          sectionName: data.sectionName,\r\n          courseId: course._id,\r\n        },\r\n        token\r\n      )\r\n    }\r\n    if (result) {\r\n      // console.log(\"section result\", result)\r\n      dispatch(setCourse(result))\r\n      setEditSectionName(null)\r\n      setValue(\"sectionName\", \"\")\r\n    }\r\n    setLoading(false)\r\n  }\r\n\r\n  const cancelEdit = () => {\r\n    setEditSectionName(null)\r\n    setValue(\"sectionName\", \"\")\r\n  }\r\n\r\n  const handleChangeEditSectionName = (sectionId, sectionName) => {\r\n    if (editSectionName === sectionId) {\r\n      cancelEdit()\r\n      return\r\n    }\r\n    setEditSectionName(sectionId)\r\n    setValue(\"sectionName\", sectionName)\r\n  }\r\n\r\n  const goToNext = () => {\r\n    if (course.courseContent.length === 0) {\r\n      toast.error(\"Please add atleast one section\")\r\n      return\r\n    }\r\n    if (\r\n      course.courseContent.some((section) => section.subSection.length === 0)\r\n    ) {\r\n      toast.error(\"Please add atleast one lecture in each section\")\r\n      return\r\n    }\r\n    dispatch(setStep(3))\r\n  }\r\n\r\n  const goBack = () => {\r\n    dispatch(setStep(1))\r\n    dispatch(setEditCourse(true))\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-8 rounded-md border-[1px] border-richblack-700 bg-richblack-800 p-6\">\r\n      <p className=\"text-2xl font-semibold text-richblack-5\">Course Builder</p>\r\n      <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\r\n        <div className=\"flex flex-col space-y-2\">\r\n          <label className=\"text-sm text-richblack-5\" htmlFor=\"sectionName\">\r\n            Section Name <sup className=\"text-pink-200\">*</sup>\r\n          </label>\r\n          <input\r\n            id=\"sectionName\"\r\n            disabled={loading}\r\n            placeholder=\"Add a section to build your course\"\r\n            {...register(\"sectionName\", { required: true })}\r\n            className=\"form-style w-full\"\r\n          />\r\n          {errors.sectionName && (\r\n            <span className=\"ml-2 text-xs tracking-wide text-pink-200\">\r\n              Section name is required\r\n            </span>\r\n          )}\r\n        </div>\r\n        <div className=\"flex items-end gap-x-4\">\r\n          <IconBtn\r\n            type=\"submit\"\r\n            disabled={loading}\r\n            text={editSectionName ? \"Edit Section Name\" : \"Create Section\"}\r\n            outline={true}\r\n          >\r\n            <IoAddCircleOutline size={20} className=\"text-yellow-50\" />\r\n          </IconBtn>\r\n          {editSectionName && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={cancelEdit}\r\n              className=\"text-sm text-richblack-300 underline\"\r\n            >\r\n              Cancel Edit\r\n            </button>\r\n          )}\r\n        </div>\r\n      </form>\r\n      {course.courseContent.length > 0 && (\r\n        <NestedView handleChangeEditSectionName={handleChangeEditSectionName} />\r\n      )}\r\n      {/* Next Prev Button */}\r\n      <div className=\"flex justify-end gap-x-3\">\r\n        <button\r\n          onClick={goBack}\r\n          className={`flex cursor-pointer items-center gap-x-2 rounded-md bg-richblack-300 py-[8px] px-[20px] font-semibold text-richblack-900`}\r\n        >\r\n          Back\r\n        </button>\r\n        <IconBtn disabled={loading} text=\"Next\" onclick={goToNext}>\r\n          <MdNavigateNext />\r\n        </IconBtn>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}