{"ast":null,"code":"import _objectSpread from\"C:/Users/s/Desktop/StudyNotion-An-Online-Education-Platform/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/s/Desktop/StudyNotion-An-Online-Education-Platform/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/s/Desktop/StudyNotion-An-Online-Education-Platform/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/s/Desktop/StudyNotion-An-Online-Education-Platform/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from\"react\";import{useForm}from\"react-hook-form\";import{toast}from\"react-hot-toast\";import{IoAddCircleOutline}from\"react-icons/io5\";import{MdNavigateNext}from\"react-icons/md\";import{useDispatch,useSelector}from\"react-redux\";import{createSection,updateSection}from\"../../../../../services/operations/courseDetailsAPI\";import{setCourse,setEditCourse,setStep}from\"../../../../../slices/courseSlice\";import IconBtn from\"../../../../common/IconBtn\";import NestedView from\"./NestedView\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function CourseBuilderForm(){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,errors=_useForm.formState.errors;var _useSelector=useSelector(function(state){return state.course;}),course=_useSelector.course;var _useSelector2=useSelector(function(state){return state.auth;}),token=_useSelector2.token;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),editSectionName=_useState4[0],setEditSectionName=_useState4[1];var dispatch=useDispatch();// handle form submission\nvar onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){var result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:// console.log(data)\nsetLoading(true);if(!editSectionName){_context.next=7;break;}_context.next=4;return updateSection({sectionName:data.sectionName,sectionId:editSectionName,courseId:course._id},token);case 4:result=_context.sent;_context.next=10;break;case 7:_context.next=9;return createSection({sectionName:data.sectionName,courseId:course._id},token);case 9:result=_context.sent;case 10:if(result){// console.log(\"section result\", result)\ndispatch(setCourse(result));setEditSectionName(null);setValue(\"sectionName\",\"\");}setLoading(false);case 12:case\"end\":return _context.stop();}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var cancelEdit=function cancelEdit(){setEditSectionName(null);setValue(\"sectionName\",\"\");};var handleChangeEditSectionName=function handleChangeEditSectionName(sectionId,sectionName){if(editSectionName===sectionId){cancelEdit();return;}setEditSectionName(sectionId);setValue(\"sectionName\",sectionName);};var goToNext=function goToNext(){if(course.courseContent.length===0){toast.error(\"Please add atleast one section\");return;}if(course.courseContent.some(function(section){return section.subSection.length===0;})){toast.error(\"Please add atleast one lecture in each section\");return;}dispatch(setStep(3));};var goBack=function goBack(){dispatch(setStep(1));dispatch(setEditCourse(true));};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-8 rounded-md border-[1px] border-richblack-700 bg-richblack-800 p-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-richblack-5\",children:\"Course Builder\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"text-sm text-richblack-5\",htmlFor:\"sectionName\",children:[\"Section Name \",/*#__PURE__*/_jsx(\"sup\",{className:\"text-pink-200\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({id:\"sectionName\",disabled:loading,placeholder:\"Add a section to build your course\"},register(\"sectionName\",{required:true})),{},{className:\"form-style w-full\"})),errors.sectionName&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-xs tracking-wide text-pink-200\",children:\"Section name is required\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-end gap-x-4\",children:[/*#__PURE__*/_jsx(IconBtn,{type:\"submit\",disabled:loading,text:editSectionName?\"Edit Section Name\":\"Create Section\",outline:true,children:/*#__PURE__*/_jsx(IoAddCircleOutline,{size:20,className:\"text-yellow-50\"})}),editSectionName&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:cancelEdit,className:\"text-sm text-richblack-300 underline\",children:\"Cancel Edit\"})]})]}),course.courseContent.length>0&&/*#__PURE__*/_jsx(NestedView,{handleChangeEditSectionName:handleChangeEditSectionName}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:goBack,className:\"flex cursor-pointer items-center gap-x-2 rounded-md bg-richblack-300 py-[8px] px-[20px] font-semibold text-richblack-900\",children:\"Back\"}),/*#__PURE__*/_jsx(IconBtn,{disabled:loading,text:\"Next\",onclick:goToNext,children:/*#__PURE__*/_jsx(MdNavigateNext,{})})]})]});}","map":{"version":3,"names":["useState","useForm","toast","IoAddCircleOutline","MdNavigateNext","useDispatch","useSelector","createSection","updateSection","setCourse","setEditCourse","setStep","IconBtn","NestedView","jsx","_jsx","jsxs","_jsxs","CourseBuilderForm","_useForm","register","handleSubmit","setValue","errors","formState","_useSelector","state","course","_useSelector2","auth","token","_useState","_useState2","_slicedToArray","loading","setLoading","_useState3","_useState4","editSectionName","setEditSectionName","dispatch","onSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","data","result","wrap","_callee$","_context","prev","next","sectionName","sectionId","courseId","_id","sent","stop","_x","apply","arguments","cancelEdit","handleChangeEditSectionName","goToNext","courseContent","length","error","some","section","subSection","goBack","className","children","htmlFor","_objectSpread","id","disabled","placeholder","required","type","text","outline","size","onClick","onclick"],"sources":["C:/Users/s/Desktop/StudyNotion-An-Online-Education-Platform/src/components/core/Dashboard/AddCourse/CourseBuilder/CourseBuilderForm.jsx"],"sourcesContent":["import { useState } from \"react\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { toast } from \"react-hot-toast\"\r\nimport { IoAddCircleOutline } from \"react-icons/io5\"\r\nimport { MdNavigateNext } from \"react-icons/md\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\n\r\nimport {\r\n  createSection,\r\n  updateSection,\r\n} from \"../../../../../services/operations/courseDetailsAPI\"\r\nimport {\r\n  setCourse,\r\n  setEditCourse,\r\n  setStep,\r\n} from \"../../../../../slices/courseSlice\"\r\nimport IconBtn from \"../../../../common/IconBtn\"\r\nimport NestedView from \"./NestedView\"\r\n\r\nexport default function CourseBuilderForm() {\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    setValue,\r\n    formState: { errors },\r\n  } = useForm()\r\n\r\n  const { course } = useSelector((state) => state.course)\r\n  const { token } = useSelector((state) => state.auth)\r\n  const [loading, setLoading] = useState(false)\r\n  const [editSectionName, setEditSectionName] = useState(null)\r\n  const dispatch = useDispatch()\r\n\r\n  // handle form submission\r\n  const onSubmit = async (data) => {\r\n    // console.log(data)\r\n    setLoading(true)\r\n\r\n    let result\r\n\r\n    if (editSectionName) {\r\n      result = await updateSection(\r\n        {\r\n          sectionName: data.sectionName,\r\n          sectionId: editSectionName,\r\n          courseId: course._id,\r\n        },\r\n        token\r\n      )\r\n      // console.log(\"edit\", result)\r\n    } else {\r\n      result = await createSection(\r\n        {\r\n          sectionName: data.sectionName,\r\n          courseId: course._id,\r\n        },\r\n        token\r\n      )\r\n    }\r\n    if (result) {\r\n      // console.log(\"section result\", result)\r\n      dispatch(setCourse(result))\r\n      setEditSectionName(null)\r\n      setValue(\"sectionName\", \"\")\r\n    }\r\n    setLoading(false)\r\n  }\r\n\r\n  const cancelEdit = () => {\r\n    setEditSectionName(null)\r\n    setValue(\"sectionName\", \"\")\r\n  }\r\n\r\n  const handleChangeEditSectionName = (sectionId, sectionName) => {\r\n    if (editSectionName === sectionId) {\r\n      cancelEdit()\r\n      return\r\n    }\r\n    setEditSectionName(sectionId)\r\n    setValue(\"sectionName\", sectionName)\r\n  }\r\n\r\n  const goToNext = () => {\r\n    if (course.courseContent.length === 0) {\r\n      toast.error(\"Please add atleast one section\")\r\n      return\r\n    }\r\n    if (\r\n      course.courseContent.some((section) => section.subSection.length === 0)\r\n    ) {\r\n      toast.error(\"Please add atleast one lecture in each section\")\r\n      return\r\n    }\r\n    dispatch(setStep(3))\r\n  }\r\n\r\n  const goBack = () => {\r\n    dispatch(setStep(1))\r\n    dispatch(setEditCourse(true))\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-8 rounded-md border-[1px] border-richblack-700 bg-richblack-800 p-6\">\r\n      <p className=\"text-2xl font-semibold text-richblack-5\">Course Builder</p>\r\n      <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\r\n        <div className=\"flex flex-col space-y-2\">\r\n          <label className=\"text-sm text-richblack-5\" htmlFor=\"sectionName\">\r\n            Section Name <sup className=\"text-pink-200\">*</sup>\r\n          </label>\r\n          <input\r\n            id=\"sectionName\"\r\n            disabled={loading}\r\n            placeholder=\"Add a section to build your course\"\r\n            {...register(\"sectionName\", { required: true })}\r\n            className=\"form-style w-full\"\r\n          />\r\n          {errors.sectionName && (\r\n            <span className=\"ml-2 text-xs tracking-wide text-pink-200\">\r\n              Section name is required\r\n            </span>\r\n          )}\r\n        </div>\r\n        <div className=\"flex items-end gap-x-4\">\r\n          <IconBtn\r\n            type=\"submit\"\r\n            disabled={loading}\r\n            text={editSectionName ? \"Edit Section Name\" : \"Create Section\"}\r\n            outline={true}\r\n          >\r\n            <IoAddCircleOutline size={20} className=\"text-yellow-50\" />\r\n          </IconBtn>\r\n          {editSectionName && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={cancelEdit}\r\n              className=\"text-sm text-richblack-300 underline\"\r\n            >\r\n              Cancel Edit\r\n            </button>\r\n          )}\r\n        </div>\r\n      </form>\r\n      {course.courseContent.length > 0 && (\r\n        <NestedView handleChangeEditSectionName={handleChangeEditSectionName} />\r\n      )}\r\n      {/* Next Prev Button */}\r\n      <div className=\"flex justify-end gap-x-3\">\r\n        <button\r\n          onClick={goBack}\r\n          className={`flex cursor-pointer items-center gap-x-2 rounded-md bg-richblack-300 py-[8px] px-[20px] font-semibold text-richblack-900`}\r\n        >\r\n          Back\r\n        </button>\r\n        <IconBtn disabled={loading} text=\"Next\" onclick={goToNext}>\r\n          <MdNavigateNext />\r\n        </IconBtn>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}